<include target="_header.html" />
<load target="css/list.css" />
<style>
.ht-table {
    width: 100%;
    border-spacing: 0;
    font-size: 15px;
}

.ht-table tbody tr td, .ht-table thead tr th {
    padding-top: 12px;
    padding-bottom: 12px;
}

.ht-order-status[data-status="DONE"] {
    border-color: #00a754;
    color: #00a754;
}

.ht-order-status[data-status="CANCELED"], .ht-order-status[data-status="FAILED"], .ht-order-status[data-status="REFUNDED"] {
    border-color:#eb331c;
    color:#eb331c;
}

.ht-tag {
    display: inline-block;
    margin-right: 6px;
    margin-bottom: 6px;
    padding: 2px 6px;
    border: #636363 1px solid;
    border-radius: 4px;
    font-size: 13px;
    color: #636363;
}

.ht-table thead tr td, .ht-table thead tr th {
    padding-bottom: 8px;
    border-bottom: #868e96 1px solid;
    text-align: left;
    font-size: 15px;
    font-weight: 400;
    color: #555;
}

.ht-order .ht-order-id {
    display: block;
    margin-bottom: 8px;
    font-size: 13px;
}

.ht-order-thumbnail img {
    width: 80px;
    height: 80px;
}

section#result p {
    margin: 10px;
}

section#result p.orange {
    background-color:#FF6F3B;
    color:white;
}
</style>

{@
$oHotopayModel = getModel('hotopay');
$daily = array('일','월','화','수','목','금','토');
}

<section class="flex-container">
    <div id="p_content">
    <div id="r_content">
        <h1>구매 목록</h1>
        <section id="result">
            <p class="orange">※ 가상계좌에 경우 입금 후 자동 입금 확인까지 최대 10분정도 소요될 수 있습니다.</p>
            <!-- <p>2021년 5월 7일 이후 구매한 것만 리스트에 나옵니다<br><a href="//shop.hoto.dev/buy_request" style="color: #ff4757;">이전 구매 기록 확인하기</a></p> -->
        </section>
        <br>
        <table class="ht-table ht-orders">
            <thead>
                <tr>
                    <th>주문 번호</th>
                    <th colspan="2">구매 상품 정보</th>
                    <th>주문 금액</th>
                    <th>주문 일시</th>
                </tr>
            </thead>
            <tbody>
                <!--@foreach($purchase_list as $purchase)-->
                {@
                    $products = $oHotopayModel->getProductsByPurchaseSrl($purchase->purchase_srl);
                    $options = $oHotopayModel->getOptionsByPurchaseSrl($purchase->purchase_srl);
                }
                <!--@foreach($products as $product)-->
                <tr class="ht-order">
                    <td>
                        <span class="ht-order-id">HT{$purchase->purchase_srl}</span>
                        <span class="ht-tag ht-order-status" data-status="{$purchase->pay_status}">{$oHotopayModel->payStatusCodeToString($purchase->pay_status)}</span>
                    </td>
                    <td>
                        <span class="ht-order-thumbnail"><img src="{$product->product_pic_src}"></span>
                    </td>
                    <td>
                        <span class="ht-order-first-item">{$product->product_name}<br>({$options[$product->product_srl]->title}){$product_data->d}</span>
                    </td>
                    <td>
                        <span class="ht-order-total">₩{number_format($purchase->product_purchase_price)}</span>
                    </td>
                    <td>
                        <span class="ht-order-created-at">{date("Y년 m월 d일 ",$purchase->regdate).$daily[date('w',$purchase->regdate)].'요일'}<br>{date("H시 i분",$purchase->regdate)}</span>
                    </td>
                </tr>
                <!--@endforeach-->
                <!--@endforeach-->

                <!--@if(count($purchase_list) < 1)-->
                <tr class="ht-order">
                    <td colspan="5">주문 목록이 없습니다.</td>
                </tr>
                <!--@endif-->
            </tbody>
        </table>
    </div>
    </div>
</section>



{@ debugPrint($purchase_list); }